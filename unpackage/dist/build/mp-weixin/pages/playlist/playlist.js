(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/playlist/playlist"],{"0665":function(t,i,n){"use strict";var e=n("c36c"),o=n.n(e);o.a},"654a":function(t,i,n){"use strict";n.r(i);var e=n("6d93"),o=n.n(e);for(var s in e)["default"].indexOf(s)<0&&function(t){n.d(i,t,(function(){return e[t]}))}(s);i["default"]=o.a},"6d93":function(t,i,n){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e=n("4406"),o={props:{fatherSongListsId:String,fatherCurrnt:Number,playerHeight:{type:Number,default:110}},data:function(){return{playlistType:"normal",loadingStatus:!0,childCurrentMusic:-1,popupContentIntroductionHeight:150,popupShow:!1,playlistinfo:{id:"initial",name:"加载中...",cover:"https://p2.music.126.net/c-u3kOlkVTUf4JdeDHDdEw==/109951163291871252.jpg",updateTime:"",creator:"一只喵喵喵星人",cat:"",playCount:"",loveCount:"",chatCount:"",introduction:"",songsNumber:"0",music_list:[]},screenHeight:0,showList:[],showListIndex:0}},mounted:function(){var i=this,n=t.getStorageSync("playlistId");this.playlistType=t.getStorageSync("playlistType"),this.showList.length=0,this.showListIndex=0,e._get("/api/playlist/getPlaylistInformation",{id:n},(function(n){i.playlistinfo=n.data["data"]["playlist"],i.loadmore(),i.fatherSongListsId==i.playlistinfo.id&&(i.childCurrentMusic=i.fatherCurrnt),t.removeStorageSync("playlistId"),t.removeStorageSync("playlistType"),i.setHeight(),i.loadingStatus=!1}))},watch:{fatherCurrnt:function(t){this.fatherSongListsId==this.playlistinfo.id?this.childCurrentMusic=t:-1!=this.childCurrentMusic&&(this.childCurrentMusic=-1)}},methods:{collectOrCancelMusic:function(i){var n,o,s=this,l=this.playlistinfo.music_list[i].music_id;this.playlistinfo.music_list[i].is_like?(n="del",o=!1):(n="add",o=!0);var u=t.getStorageSync("collectionPlaylistId");e._get("/api/music/collectOrCancelMusic",{musicId:l,playlistId:u,op:n},(function(t){if(t.data["data"]["success"])if("normal"==s.playlistType)s.playlistinfo.music_list[i].is_like=o;else if(s.playlistinfo.music_list[i].is_like){s.playlistinfo.music_list.splice(i,1);-1!=s.childCurrentMusic&&(s.childCurrentMusic=-1,s.changePlaylistId()),s.playlistinfo.songsNumber=s.playlistinfo.songsNumber-1}else s.playlistinfo.music_list[i].is_like=o}))},changePlaylistId:function(){this.$emit("changePlaylistId","change")},copywa:function(i){t.setClipboardData({data:i,success:function(i){t.showToast({title:"复制成功"})},fail:function(){t.showToast({title:"复制失败了"})}})},downloadMusic:function(i){var n=this;e._get("/api/music/getMusicURLById",{id:this.playlistinfo.music_list[i].music_id},(function(i){var e=t.downloadFile({url:i.data["data"]["url"],success:function(i){200===i.statusCode&&(console.log("下载成功"),t.saveFile({tempFilePath:i.tempFilePath,success:function(i){t.hideLoading(),t.showToast({icon:"success",title:"下载成功！"}),console.log("保存成功"+i.savedFilePath)}}))},fail:function(e){t.hideLoading(),t.showModal({title:"提示",content:"下载失败，可以通过浏览器链接下载，是否复制链接自行去浏览器下载？",success:function(t){t.confirm?n.copywa(i.data["data"]["url"]):t.cancel&&console.log("用户点击取消")}}),console.log(e)}});e.onProgressUpdate((function(i){t.showLoading({title:"下载进度"+i.progress+"%"})}))}))},setHeight:function(){var i=this,n=this.playerHeight,e=t.getSystemInfoSync().statusBarHeight,o=t.$u.getPx(t.$u.getPx("20rpx",!0)),s=0,l=0,u=t.createSelectorQuery().in(this),a=t.createSelectorQuery().in(this);u.select(".playlist-info").boundingClientRect((function(u){s=u.height,a.select(".playlist-songlist-button").boundingClientRect((function(u){l=u.height,i.screenHeight=t.getSystemInfoSync().windowHeight-s-n-e-o-45-l})).exec()})).exec()},playCountFormat:function(t){return e.playCountFormat(t)},playAllMusics:function(){if(0==this.playlistinfo.music_list.length)t.showToast({icon:"none",title:"没有歌曲"});else{this.childCurrentMusic=0;var i={childSongListsId:this.playlistinfo.id,index:0};this.$emit("getChild",i)}},playOneMusic:function(t){this.childCurrentMusic=t;var i={childSongListsId:this.playlistinfo.id,index:t};this.$emit("getChild",i)},loadmore:function(){if(this.showListIndex==Number(this.playlistinfo.songsNumber)&&0!=Number(this.playlistinfo.songsNumber))t.showToast({icon:"none",title:"到底了..."});else{var i=this.showListIndex,n=30;n=i+30>=Number(this.playlistinfo.songsNumber)?Number(this.playlistinfo.songsNumber):i+30;for(var e=i;e<n;e++)this.showList.push(this.playlistinfo.music_list[e]),this.showListIndex=this.showListIndex+1}},scrolltolower:function(){this.loadmore()},openPopup:function(){var t=this;this.popupShow=!0,setTimeout((function(){t.setPopupContentHeight()}),310)},PopupClose:function(){this.popupShow=!1},setPopupContentHeight:function(){var i=this,n=t.createSelectorQuery().in(this),e=t.createSelectorQuery().in(this),o=0,s=0,l=t.$u.getPx(t.$u.getPx("830rpx",!0));n.select(".popupContent-cover-name").boundingClientRect((function(t){o=t.height,e.select(".popupContent-creator-cat").boundingClientRect((function(t){s=t.height,i.popupContentIntroductionHeight=l-o-s})).exec()})).exec()}}};i.default=o}).call(this,n("543d")["default"])},"6f66":function(t,i,n){"use strict";(function(t,i){var e=n("4ea4");n("54c0");e(n("66fd"));var o=e(n("b136"));t.__webpack_require_UNI_MP_PLUGIN__=n,i(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},b136:function(t,i,n){"use strict";n.r(i);var e=n("bfbf"),o=n("654a");for(var s in o)["default"].indexOf(s)<0&&function(t){n.d(i,t,(function(){return o[t]}))}(s);n("0665");var l=n("f0c5"),u=Object(l["a"])(o["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],void 0);i["default"]=u.exports},bfbf:function(t,i,n){"use strict";n.d(i,"b",(function(){return o})),n.d(i,"c",(function(){return s})),n.d(i,"a",(function(){return e}));var e={"u-Image":function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u--image/u--image")]).then(n.bind(null,"c361"))},"u-Text":function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u--text/u--text")]).then(n.bind(null,"7545"))},uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"a1dd"))},uButton:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-button/u-button")]).then(n.bind(null,"a5c8"))},uList:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-list/u-list")]).then(n.bind(null,"1a0f"))},uListItem:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-list-item/u-list-item")]).then(n.bind(null,"d11d"))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,"69f0"))},uLine:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-line/u-line")]).then(n.bind(null,"5e37"))},uLoadingPage:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-loading-page/u-loading-page")]).then(n.bind(null,"ceec"))}},o=function(){var t=this,i=t.$createElement,n=(t._self._c,""!=t.playlistinfo.playCount?t.playCountFormat(t.playlistinfo.playCount):null),e=""!=t.playlistinfo.playCount?t.playCountFormat(t.playlistinfo.loveCount):null,o=""!=t.playlistinfo.playCount?t.playCountFormat(t.playlistinfo.chatCount):null;t.$mp.data=Object.assign({},{$root:{m0:n,m1:e,m2:o}})},s=[]},c36c:function(t,i,n){}},[["6f66","common/runtime","common/vendor"]]]);